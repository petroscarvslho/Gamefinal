<!DOCTYPE html>
<html>
<head>
  <title>LimeZu Tile Preview - MediQuest</title>
  <style>
    * { box-sizing: border-box; }
    body {
      background: #0f172a;
      color: white;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 10px;
    }
    h1 {
      color: #22d3ee;
      margin: 0 0 10px 0;
      font-size: 20px;
    }

    .container {
      display: flex;
      gap: 10px;
      height: calc(100vh - 50px);
    }

    /* Painel esquerdo - Sprite Sheet */
    .sprite-panel {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: #1e293b;
      border-radius: 8px;
      padding: 10px;
      overflow: hidden;
    }

    .sheet-tabs {
      display: flex;
      gap: 5px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    .sheet-tab {
      padding: 8px 12px;
      background: #334155;
      border: none;
      border-radius: 5px;
      color: #94a3b8;
      cursor: pointer;
      font-size: 12px;
      font-weight: bold;
    }

    .sheet-tab:hover { background: #475569; }
    .sheet-tab.active {
      background: #0891b2;
      color: white;
    }

    .sprite-container {
      flex: 1;
      overflow: auto;
      background: #0f172a;
      border-radius: 5px;
      padding: 10px;
    }

    .sprite-grid {
      display: grid;
      gap: 2px;
    }

    .tile {
      width: 48px;
      height: 48px;
      background: #1e293b;
      border: 2px solid transparent;
      cursor: pointer;
      position: relative;
      image-rendering: pixelated;
    }

    .tile:hover {
      border-color: #22d3ee;
      z-index: 10;
      transform: scale(1.1);
    }

    .tile.selected {
      border-color: #22c55e;
      box-shadow: 0 0 10px #22c55e;
    }

    .tile canvas {
      width: 100%;
      height: 100%;
      image-rendering: pixelated;
    }

    .tile .coord {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0,0,0,0.8);
      font-size: 8px;
      text-align: center;
      color: #fbbf24;
      padding: 1px;
    }

    /* Painel direito - Info e Preview */
    .info-panel {
      width: 300px;
      background: #1e293b;
      border-radius: 8px;
      padding: 15px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .info-section {
      background: #0f172a;
      padding: 15px;
      border-radius: 8px;
    }

    .info-section h3 {
      color: #22d3ee;
      margin: 0 0 10px 0;
      font-size: 14px;
    }

    .preview-canvas {
      width: 128px;
      height: 128px;
      margin: 0 auto;
      display: block;
      background: #1e293b;
      border: 3px solid #22d3ee;
      image-rendering: pixelated;
    }

    .coord-display {
      text-align: center;
      margin-top: 10px;
      font-family: monospace;
      font-size: 18px;
      color: #22c55e;
    }

    .sheet-info {
      color: #94a3b8;
      font-size: 12px;
    }

    .code-output {
      background: #0f172a;
      padding: 10px;
      border-radius: 5px;
      font-family: monospace;
      font-size: 11px;
      color: #fbbf24;
      word-break: break-all;
    }

    .copy-btn {
      width: 100%;
      padding: 10px;
      background: #7c3aed;
      border: none;
      border-radius: 5px;
      color: white;
      cursor: pointer;
      font-weight: bold;
      margin-top: 10px;
    }

    .copy-btn:hover { background: #8b5cf6; }

    .row-nav {
      display: flex;
      gap: 5px;
      align-items: center;
      margin-bottom: 10px;
    }

    .row-nav input {
      width: 60px;
      padding: 5px;
      background: #334155;
      border: 1px solid #475569;
      border-radius: 4px;
      color: white;
    }

    .row-nav button {
      padding: 5px 10px;
      background: #334155;
      border: none;
      border-radius: 4px;
      color: white;
      cursor: pointer;
    }

    .row-nav button:hover { background: #475569; }

    .zoom-controls {
      display: flex;
      gap: 5px;
      align-items: center;
    }

    .zoom-btn {
      padding: 5px 12px;
      background: #334155;
      border: none;
      border-radius: 4px;
      color: white;
      cursor: pointer;
    }

    .zoom-btn:hover { background: #475569; }
    .zoom-btn.active { background: #0891b2; }
  </style>
</head>
<body>
  <h1>üè• LimeZu Tile Preview - MediQuest</h1>

  <div class="container">
    <!-- Sprite Sheet Panel -->
    <div class="sprite-panel">
      <div class="sheet-tabs" id="sheetTabs"></div>

      <div class="row-nav">
        <span style="color: #94a3b8; font-size: 12px;">Linha:</span>
        <input type="number" id="rowInput" value="0" min="0">
        <button onclick="goToRow()">Ir</button>
        <span style="margin-left: 20px; color: #94a3b8; font-size: 12px;">Zoom:</span>
        <div class="zoom-controls">
          <button class="zoom-btn" onclick="setZoom(32)">1x</button>
          <button class="zoom-btn active" onclick="setZoom(48)">1.5x</button>
          <button class="zoom-btn" onclick="setZoom(64)">2x</button>
          <button class="zoom-btn" onclick="setZoom(96)">3x</button>
        </div>
      </div>

      <div class="sprite-container" id="spriteContainer">
        <div class="sprite-grid" id="spriteGrid"></div>
      </div>
    </div>

    <!-- Info Panel -->
    <div class="info-panel">
      <div class="info-section">
        <h3>üìç TILE SELECIONADO</h3>
        <canvas id="previewCanvas" class="preview-canvas" width="128" height="128"></canvas>
        <div class="coord-display" id="coordDisplay">Clique em um tile</div>
      </div>

      <div class="info-section">
        <h3>üìã SPRITE SHEET</h3>
        <div class="sheet-info" id="sheetInfo">
          Selecione um sprite sheet
        </div>
      </div>

      <div class="info-section">
        <h3>üíª C√ìDIGO</h3>
        <div class="code-output" id="codeOutput">
          Selecione um tile para ver o c√≥digo
        </div>
        <button class="copy-btn" onclick="copyCode()">üìã Copiar C√≥digo</button>
      </div>
    </div>
  </div>

  <script>
    const SPRITE_SHEETS = {
      'floors': { file: 'Room_Builder_Floors_32x32.png', name: 'üè• FLOORS (Pisos)' },
      'walls': { file: 'Room_Builder_Walls_32x32.png', name: 'üß± WALLS (Paredes)' },
      'hospital': { file: 'Hospital_32x32.png', name: 'üè® Hospital' },
      'interiors': { file: 'Interiors_32x32.png', name: 'ü™ë Interiors' },
      'generic': { file: 'Generic_32x32.png', name: 'üì¶ Generic' },
      'bathroom': { file: 'Bathroom_32x32.png', name: 'üöø Bathroom' },
      'roomBuilder': { file: 'Room_Builder_32x32.png', name: 'üè† Room Builder' },
    };

    let currentSheet = 'floors';
    let currentImage = null;
    let selectedTile = null;
    let tileSize = 48;
    const TILE_PX = 32;

    // Criar tabs
    const tabsContainer = document.getElementById('sheetTabs');
    Object.entries(SPRITE_SHEETS).forEach(([key, sheet]) => {
      const btn = document.createElement('button');
      btn.className = 'sheet-tab' + (key === currentSheet ? ' active' : '');
      btn.textContent = sheet.name;
      btn.onclick = () => loadSheet(key);
      tabsContainer.appendChild(btn);
    });

    function loadSheet(sheetKey) {
      currentSheet = sheetKey;
      const sheet = SPRITE_SHEETS[sheetKey];

      // Update tabs
      document.querySelectorAll('.sheet-tab').forEach((tab, i) => {
        tab.className = 'sheet-tab' + (Object.keys(SPRITE_SHEETS)[i] === sheetKey ? ' active' : '');
      });

      const img = new Image();
      img.onload = () => {
        currentImage = img;
        const cols = Math.floor(img.width / TILE_PX);
        const rows = Math.floor(img.height / TILE_PX);

        document.getElementById('sheetInfo').innerHTML = `
          <strong>${sheet.name}</strong><br>
          Arquivo: ${sheet.file}<br>
          Dimens√µes: ${img.width}x${img.height}px<br>
          Grid: ${cols} colunas x ${rows} linhas<br>
          Total: ${cols * rows} tiles
        `;

        renderGrid();
      };
      img.src = '/assets/limezu/interiors/' + sheet.file;
    }

    function renderGrid() {
      if (!currentImage) return;

      const grid = document.getElementById('spriteGrid');
      grid.innerHTML = '';

      const cols = Math.floor(currentImage.width / TILE_PX);
      const rows = Math.floor(currentImage.height / TILE_PX);

      grid.style.gridTemplateColumns = `repeat(${cols}, ${tileSize}px)`;

      for (let y = 0; y < rows; y++) {
        for (let x = 0; x < cols; x++) {
          const tile = document.createElement('div');
          tile.className = 'tile';
          tile.style.width = tileSize + 'px';
          tile.style.height = tileSize + 'px';

          const canvas = document.createElement('canvas');
          canvas.width = TILE_PX;
          canvas.height = TILE_PX;
          const ctx = canvas.getContext('2d');
          ctx.imageSmoothingEnabled = false;
          ctx.drawImage(currentImage, x * TILE_PX, y * TILE_PX, TILE_PX, TILE_PX, 0, 0, TILE_PX, TILE_PX);

          const coord = document.createElement('div');
          coord.className = 'coord';
          coord.textContent = `${x},${y}`;

          tile.appendChild(canvas);
          tile.appendChild(coord);
          tile.onclick = () => selectTile(x, y, tile);

          grid.appendChild(tile);
        }
      }
    }

    function selectTile(x, y, element) {
      // Remove previous selection
      document.querySelectorAll('.tile.selected').forEach(t => t.classList.remove('selected'));
      element.classList.add('selected');

      selectedTile = { x, y };

      // Update preview
      const preview = document.getElementById('previewCanvas');
      const ctx = preview.getContext('2d');
      ctx.imageSmoothingEnabled = false;
      ctx.fillStyle = '#1e293b';
      ctx.fillRect(0, 0, 128, 128);
      ctx.drawImage(currentImage, x * TILE_PX, y * TILE_PX, TILE_PX, TILE_PX, 0, 0, 128, 128);

      // Update coord display
      document.getElementById('coordDisplay').innerHTML = `x: <strong>${x}</strong>, y: <strong>${y}</strong>`;

      // Update code
      document.getElementById('codeOutput').textContent =
        `{ sheet: '${currentSheet}', x: ${x}, y: ${y} }`;
    }

    function copyCode() {
      if (!selectedTile) return;
      const code = `{ sheet: '${currentSheet}', x: ${selectedTile.x}, y: ${selectedTile.y} }`;
      navigator.clipboard.writeText(code);
      alert('C√≥digo copiado!');
    }

    function goToRow() {
      const row = parseInt(document.getElementById('rowInput').value) || 0;
      const container = document.getElementById('spriteContainer');
      const cols = currentImage ? Math.floor(currentImage.width / TILE_PX) : 1;
      container.scrollTop = row * (tileSize + 2);
    }

    function setZoom(size) {
      tileSize = size;
      document.querySelectorAll('.zoom-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.textContent.includes(size === 32 ? '1x' : size === 48 ? '1.5x' : size === 64 ? '2x' : '3x')) {
          btn.classList.add('active');
        }
      });
      renderGrid();
    }

    // Load initial sheet
    loadSheet('floors');
  </script>
</body>
</html>
